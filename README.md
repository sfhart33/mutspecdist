AMSD github README
================

# mutspecdist: package to run Aggregate Mutation Spectrum Distance (AMSD)

*figure image here*

## Installation

## Example

Load example data

``` r
data(mouse_sample_table)
data(mouse_carcinogen_spectra)
head(mouse_sample_table)
```

    ##                          label tissue            exposure rep
    ## 1 KIDNEY_VINYLIDENE_CHLORIDE_1 KIDNEY VINYLIDENE_CHLORIDE   1
    ## 2 KIDNEY_VINYLIDENE_CHLORIDE_2 KIDNEY VINYLIDENE_CHLORIDE   2
    ## 3 KIDNEY_VINYLIDENE_CHLORIDE_3 KIDNEY VINYLIDENE_CHLORIDE   3
    ## 4 KIDNEY_VINYLIDENE_CHLORIDE_4 KIDNEY VINYLIDENE_CHLORIDE   4
    ## 5 KIDNEY_VINYLIDENE_CHLORIDE_5 KIDNEY VINYLIDENE_CHLORIDE   5
    ## 6 KIDNEY_VINYLIDENE_CHLORIDE_6 KIDNEY VINYLIDENE_CHLORIDE   6

``` r
head(mouse_carcinogen_spectra)
```

    ##                                  ACA>AAA     ACC>AAC      ACG>AAG     ACT>AAT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.009253309 0.006811464 0.0002570364 0.007325537
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.011931394 0.008699975 0.0013671390 0.009569973
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.008914848 0.006455579 0.0006148171 0.009837073
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.011163829 0.005861010 0.0013954786 0.008372872
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.007226014 0.006021678 0.0014050582 0.007627459
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.007545390 0.004715869 0.0004715869 0.005894836
    ##                                 CCA>CAA     CCC>CAC      CCG>CAG     CCT>CAT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.01040997 0.006040355 0.0010281455 0.006554427
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.01652995 0.004722844 0.0006214268 0.010564256
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.01352598 0.004303720 0.0003074085 0.010144482
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.01255931 0.005581915 0.0008372872 0.008093776
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.01083902 0.003813729 0.0004014452 0.006222401
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.01084650 0.006602216 0.0009431738 0.005894836
    ##                                  GCA>GAA     GCC>GAC      GCG>GAG     GCT>GAT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.004883691 0.002184809 0.0005140727 0.003727027
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.007829978 0.003852846 0.0003728561 0.006089983
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.005840762 0.002459268 0.0003074085 0.005840762
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.005581915 0.003907340 0.0008372872 0.006140106
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.005820955 0.003412284 0.0002007226 0.004817342
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.004715869 0.001886348 0.0002357934 0.005423249
    ##                                  TCA>TAA     TCC>TAC      TCG>TAG     TCT>TAT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.005911837 0.003727027 0.0001285182 0.007068500
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.009072831 0.006711409 0.0004971414 0.011061397
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.004611128 0.006455579 0.0012296342 0.009222256
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.006977393 0.003907340 0.0011163829 0.015629361
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.004817342 0.006021678 0.0006021678 0.008430349
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.004951662 0.004244282 0.0004715869 0.007781184
    ##                                  ACA>AGA      ACC>AGC      ACG>AGG      ACT>AGT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.006040355 0.0011566637 0.0005140727 0.0017992546
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.004474273 0.0006214268 0.0006214268 0.0012428536
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.003381494 0.0012296342 0.0003074085 0.0024592684
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.002511862 0.0002790957 0.0002790957 0.0008372872
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.004415897 0.0014050582 0.0006021678 0.0018065034
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.003065315 0.0002357934 0.0007073803 0.0028295213
    ##                                  CCA>CGA     CCC>CGC      CCG>CGG     CCT>CGT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.004626655 0.002570364 0.0007711091 0.004755173
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.005468556 0.001739995 0.0007457122 0.003231419
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.004918537 0.001537043 0.0009222256 0.003074085
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.003070053 0.001953670 0.0002790957 0.001953670
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.003813729 0.003211562 0.0000000000 0.004215175
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.004480075 0.002357934 0.0014147607 0.003301108
    ##                                  GCA>GGA     GCC>GGC      GCG>GGG     GCT>GGT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.002827400 0.002313327 0.0002570364 0.002056291
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.001367139 0.002485707 0.0003728561 0.002485707
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.001844451 0.002151860 0.0009222256 0.001844451
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.001116383 0.001674574 0.0002790957 0.003070053
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.001806503 0.001405058 0.0006021678 0.001405058
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.002593728 0.004008489 0.0004715869 0.002593728
    ##                                  TCA>TGA     TCC>TGC      TCG>TGG     TCT>TGT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.003727027 0.002570364 0.0005140727 0.003598509
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.003231419 0.002485707 0.0004971414 0.003355705
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.003074085 0.002151860 0.0003074085 0.003381494
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.002232766 0.001395479 0.0000000000 0.003070053
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.004014452 0.001605781 0.0002007226 0.003412284
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.005423249 0.001650554 0.0007073803 0.004715869
    ##                                 ACA>ATA     ACC>ATC     ACG>ATG    ACT>ATT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.02017736 0.011695155 0.004626655 0.01850662
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.01553567 0.008327119 0.004225702 0.01652995
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.01260375 0.006762988 0.004611128 0.01537043
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.01842032 0.012280212 0.015350265 0.01786213
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.02288238 0.007226014 0.011039743 0.01425130
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.01391181 0.007545390 0.008488564 0.01202547
    ##                                 CCA>CTA     CCC>CTC     CCG>CTG     CCT>CTT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.01709292 0.008482200 0.001156664 0.019663282
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.01379567 0.006338553 0.001615710 0.013919960
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.01168152 0.002766677 0.003996311 0.012603750
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.01535027 0.007814680 0.007535585 0.008931063
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.01605781 0.005419510 0.005018065 0.012244079
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.01249705 0.005423249 0.003536902 0.007545390
    ##                                  GCA>GTA     GCC>GTC      GCG>GTG     GCT>GTT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.006939982 0.005783318 0.0033414728 0.009253309
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.009197117 0.004101417 0.0028585633 0.009321402
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.004611128 0.003381494 0.0009222256 0.006455579
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.008931063 0.005023723 0.0150711694 0.008931063
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.008831794 0.002609394 0.0038137294 0.007426736
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.008488564 0.003301108 0.0028295213 0.005187456
    ##                                  TCA>TTA     TCC>TTC     TCG>TTG    TCT>TTT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.010924046 0.008610718 0.002184809 0.01850662
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.011309968 0.007457122 0.002112851 0.01441710
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.006762988 0.004611128 0.003381494 0.01075930
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.013675691 0.007535585 0.006977393 0.02037399
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.012043356 0.010437575 0.002207949 0.01525492
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.010139118 0.006838010 0.003065315 0.01509078
    ##                                 ATA>AAA     ATC>AAC    ATG>AAG    ATT>AAT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.02814548 0.005397764 0.01837810 0.02904511
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.03044991 0.008327119 0.01951280 0.01652995
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.02766677 0.006762988 0.01752229 0.01414079
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.02595590 0.008651968 0.02093218 0.01646665
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.02569249 0.004817342 0.01766359 0.01324769
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.02240038 0.006130630 0.01532657 0.01509078
    ##                                 CTA>CAA     CTC>CAC    CTG>CAG    CTT>CAT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.02943066 0.009253309 0.02416142 0.01503663
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.04374845 0.018394233 0.03218991 0.02199851
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.04918537 0.021211190 0.04150015 0.02858899
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.03907340 0.012001116 0.02539771 0.01981580
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.03331995 0.014251305 0.01987154 0.02348454
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.03159632 0.014383400 0.02452252 0.02004244
    ##                                  GTA>GAA     GTC>GAC     GTG>GAG     GTT>GAT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.009767382 0.003855546 0.007454055 0.005269246
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.012179965 0.006338553 0.010191399 0.005344270
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.011681525 0.007685214 0.010144482 0.009837073
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.013117499 0.003907340 0.010884733 0.006977393
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.010236853 0.004415897 0.008831794 0.005018065
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.008488564 0.004480075 0.008016977 0.004951662
    ##                                 TTA>TAA     TTC>TAC    TTG>TAG    TTT>TAT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.03187251 0.006425909 0.01465107 0.02056291
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.03653990 0.010315685 0.01590853 0.01690281
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.04088534 0.009222256 0.01321857 0.01752229
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.03404968 0.004744627 0.01088473 0.01283840
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.03793657 0.007226014 0.01304697 0.01846648
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.02947418 0.007545390 0.01084650 0.01296864
    ##                                 ATA>ACA     ATC>ACC    ATG>ACG     ATT>ACT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.02660326 0.007068500 0.01400848 0.014651073
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.01802138 0.005841412 0.01118568 0.010439970
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.02305564 0.006455579 0.01229634 0.009837073
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.02232766 0.006140106 0.01507117 0.011163829
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.02107587 0.006623846 0.01445203 0.012043356
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.02900259 0.007545390 0.01721292 0.016505541
    ##                                 CTA>CCA     CTC>CCC    CTG>CCG    CTT>CCT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.04498136 0.011438118 0.01747847 0.03534250
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.04337559 0.008948546 0.02125280 0.02535421
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.05102982 0.013525976 0.01905933 0.03688903
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.04298074 0.012559308 0.01953670 0.02707229
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.05499799 0.009433962 0.02027298 0.03191489
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.05541146 0.016269748 0.02570149 0.03607640
    ##                                 GTA>GCA     GTC>GCC    GTG>GCG    GTT>GCT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.04086878 0.009510346 0.01979180 0.02339031
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.04747701 0.009445687 0.02025851 0.02199851
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.04057793 0.008914848 0.02059637 0.02213342
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.04130617 0.007535585 0.01590846 0.02986324
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.05319149 0.007226014 0.02228021 0.02930550
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.05069559 0.014854987 0.02051403 0.02758783
    ##                                 TTA>TCA    TTC>TCC    TTG>TCG    TTT>TCT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.06721501 0.01169515 0.01555070 0.03328621
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.06276411 0.01081283 0.01516281 0.03057420
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.07408546 0.01106671 0.01752229 0.03442976
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.06698298 0.01311750 0.01618755 0.03293330
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.07326375 0.00923324 0.01766359 0.03151345
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.07191700 0.01461919 0.01721292 0.03890592
    ##                                  ATA>AGA      ATC>AGC     ATG>AGG     ATT>AGT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.005654800 0.0014137000 0.003341473 0.004112582
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.006959980 0.0011185682 0.004474273 0.001864280
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.002151860 0.0009222256 0.003381494 0.002459268
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.004744627 0.0008372872 0.002511862 0.002232766
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.008229627 0.0014050582 0.006021678 0.003010839
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.008724357 0.0011789672 0.004480075 0.004244282
    ##                                  CTA>CGA     CTC>CGC     CTG>CGG     CTT>CGT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.003341473 0.003341473 0.005012209 0.007454055
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.003479990 0.002112851 0.004722844 0.002237136
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.001229634 0.001537043 0.004303720 0.003381494
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.004186436 0.001395479 0.004744627 0.004465532
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.004215175 0.004616620 0.004616620 0.003412284
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.003301108 0.002122141 0.006838010 0.004244282
    ##                                  GTA>GGA      GTC>GGC     GTG>GGG      GTT>GGT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.002441846 0.0010281455 0.003598509 0.0034699910
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.001367139 0.0004971414 0.001988566 0.0011185682
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.001229634 0.0009222256 0.002766677 0.0006148171
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.001116383 0.0008372872 0.001953670 0.0016745744
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.002408671 0.0008028904 0.002609394 0.0020072260
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.002357934 0.0009431738 0.004951662 0.0023579344
    ##                                  TTA>TGA      TTC>TGC     TTG>TGG     TTT>TGT
    ## KIDNEY_VINYLIDENE_CHLORIDE_1 0.005012209 0.0019277728 0.005911837 0.008482200
    ## KIDNEY_VINYLIDENE_CHLORIDE_2 0.004847129 0.0018642804 0.004598558 0.003977131
    ## KIDNEY_VINYLIDENE_CHLORIDE_3 0.005225945 0.0009222256 0.003996311 0.001844451
    ## KIDNEY_VINYLIDENE_CHLORIDE_4 0.003628244 0.0019536701 0.003070053 0.002232766
    ## KIDNEY_VINYLIDENE_CHLORIDE_5 0.005820955 0.0008028904 0.004817342 0.004817342
    ## KIDNEY_VINYLIDENE_CHLORIDE_6 0.004951662 0.0021221410 0.006366423 0.005423249

Example comparison: TCP-exposed vs control mouse tumors

``` r
# mutation spectra for tumors exposed to TCP
  exposure <- mouse_sample_table$exposure == "1,2,3_TRICHLOROPROPANE" &
    mouse_sample_table$tissue == "LIVER"
  exp_samples <-  mouse_sample_table$label[exposure]
  exp_spectra <- mouse_carcinogen_spectra[exp_samples,]
  exp_samples
```

    ## [1] "LIVER_1,2,3_TRICHLOROPROPANE_1" "LIVER_1,2,3_TRICHLOROPROPANE_2"
    ## [3] "LIVER_1,2,3_TRICHLOROPROPANE_3" "LIVER_1,2,3_TRICHLOROPROPANE_4"

``` r
# mutation spectra for spontaneously arising tumors
  control <- mouse_sample_table$exposure == "SPONTANEOUS" &
      mouse_sample_table$tissue == "LIVER"
  con_samples <- mouse_sample_table$label[control]
  con_spectra <- mouse_carcinogen_spectra[con_samples,]
  con_samples
```

    ##  [1] "LIVER_SPONTANEOUS_1"  "LIVER_SPONTANEOUS_10" "LIVER_SPONTANEOUS_11"
    ##  [4] "LIVER_SPONTANEOUS_2"  "LIVER_SPONTANEOUS_3"  "LIVER_SPONTANEOUS_4" 
    ##  [7] "LIVER_SPONTANEOUS_5"  "LIVER_SPONTANEOUS_6"  "LIVER_SPONTANEOUS_7" 
    ## [10] "LIVER_SPONTANEOUS_8"  "LIVER_SPONTANEOUS_9"

Run AMSD and plot output

``` r
# Run AMSD
  exp_v_con <- amsd(exp_spectra,
                    con_spectra,
                    seed = 123)
# Visualize result
  plot_amsd_histogram(exp_v_con)
```

    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

![](README_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->
